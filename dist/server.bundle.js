(()=>{"use strict";var e,r,o,t,s,n={9469:(e,r,o)=>{o.d(r,{_:()=>s});var t=o(2613);const s=(0,o(7546).load)({PORT:Number,NODE_ENV:["production","development"],MORGAN:["combined","dev","tiny"],APP_NAME:String,BASE_URL:String,BASE64_ENCODED:Buffer,TRACING:Boolean,EXTRA:String,RARE_LIMIT_TIME:Number,RARE_LIMIT_WINDOW_MS:Number,MAX:Number,RARE_LIMIT_MESSAGE:String,RARE_LIMIT_CODE:Number,TRUST_PROXY:Boolean,NUMBER_OF_PROXIES:Number,IDLE_TIMEOUT:Number,COMPRESSION_LEVEL:Number,COMPRESSION_THRESHOLD:Number,ERROR_TIMEOUT:Number,RESPONSE_STATUS:String,RESPONSE_MESSAGE:String,RESPONSE_CODE:Number,RESPONSE_ERROR_CODE:Number,RESPONSE_ERROR_MESSAGE:String,RESPONSE_SERVER_ERROR:String,RESPONSE_ERROR_STATUS:String,RESPONSE_ERROR_DATA:String,RESPONSE_ERROR_STACK:String,RESPONSE_ERROR_NAME:String}),{APP_NAME:n,TRACING:i,PORT:u,MORGAN:l,NODE_ENV:a,BASE_URL:c,BASE64_ENCODED:E,EXTRA:d,RARE_LIMIT_TIME:R,RARE_LIMIT_WINDOW_MS:_,RESPONSE_ERROR_CODE:p,MAX:S,RARE_LIMIT_MESSAGE:m,RARE_LIMIT_CODE:O,TRUST_PROXY:b,NUMBER_OF_PROXIES:h,IDLE_TIMEOUT:f,COMPRESSION_LEVEL:g,COMPRESSION_THRESHOLD:k,ERROR_TIMEOUT:N}=s;if(500===p)throw new Error("Internal Server Error! No env file found!");if(t.strict.ok(i,"Tracing should be true"),t.strict.ok(8081===u,"Port should be 8081"),t.strict.ok("production"===a,"Node environment should be production"),t.strict.ok("http://localhost:8081"===c,"Base URL should be correct"),t.strict.ok(E.equals(Buffer.from("ðŸš€")),"Base64 encoded value should match"),t.strict.ok("true"===d,"Extra should be true"),t.strict.ok(9e5===R,"Rate limit time should be 15m"),t.strict.ok(9e5===_,"Rate limit window should be 15m"),t.strict.ok(100===S,"Max should be 100"),t.strict.ok(m,"Too many requests, please try again later"),t.strict.ok(429===O,"Rate limit code should be 429"),t.strict.ok(b,"Trust proxy should be true initially"),t.strict.ok(1===h,"Number of proxies should be 1"),t.strict.ok(48e4===f,"Idle timeout should be 8m"),t.strict.ok(9===g,"Compression level should be 9"),t.strict.ok(1024===k,"Compression threshold should be 1024"),t.strict.ok(5e3===N,"Error timeout should be 5s"),!/^[a-zA-Z0-9-.]+$/.test(n))throw new Error(`Invalid APP_NAME: ${n}`)},423:e=>{e.exports=require("@sequelize/core")},5520:e=>{e.exports=require("@sequelize/mariadb")},5486:e=>{e.exports=require("bcrypt")},3268:e=>{e.exports=require("body-parser")},6898:e=>{e.exports=require("cookie-parser")},8577:e=>{e.exports=require("cors")},818:e=>{e.exports=require("dotenv")},4469:e=>{e.exports=require("dotenv/config")},7252:e=>{e.exports=require("express")},1763:e=>{e.exports=require("express-rate-limit")},2525:e=>{e.exports=require("helmet")},829:e=>{e.exports=require("jsonwebtoken")},2096:e=>{e.exports=require("morgan")},8461:e=>{e.exports=require("multer")},9031:e=>{e.exports=require("sequelize")},7546:e=>{e.exports=require("ts-dotenv")},7189:e=>{e.exports=require("validate-image-type")},2613:e=>{e.exports=require("assert")},6982:e=>{e.exports=require("crypto")},9896:e=>{e.exports=require("fs")},3024:e=>{e.exports=require("node:fs")},6760:e=>{e.exports=require("node:path")},643:e=>{e.exports=require("node:perf_hooks")},1708:e=>{e.exports=require("node:process")},3136:e=>{e.exports=require("node:url")},6928:e=>{e.exports=require("path")}},i={};function u(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return n[e](o,o.exports,u),o.exports}u.m=n,e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",r="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",o="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",t=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},u.a=(s,n,i)=>{var u;i&&((u=[]).d=-1);var l,a,c,E=new Set,d=s.exports,R=new Promise(((e,r)=>{c=r,a=e}));R[r]=d,R[e]=e=>(u&&e(u),E.forEach(e),R.catch((e=>{}))),s.exports=R,n((s=>{var n;l=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var n=[];n.d=0,s.then((e=>{i[r]=e,t(n)}),(e=>{i[o]=e,t(n)}));var i={};return i[e]=e=>e(n),i}}var u={};return u[e]=e=>{},u[r]=s,u})))(s);var i=()=>l.map((e=>{if(e[o])throw e[o];return e[r]})),a=new Promise((r=>{(n=()=>r(i)).r=0;var o=e=>e!==u&&!E.has(e)&&(E.add(e),e&&!e.d&&(n.r++,e.push(n)));l.map((r=>r[e](o)))}));return n.r?a:i()}),(e=>(e?c(R[o]=e):a(d),t(u)))),u&&u.d<0&&(u.d=0)},u.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return u.d(r,{a:r}),r},u.d=(e,r)=>{for(var o in r)u.o(r,o)&&!u.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},u.f={},u.e=e=>Promise.all(Object.keys(u.f).reduce(((r,o)=>(u.f[o](e,r),r)),[])),u.u=e=>e+".bundle.js",u.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s={750:1},u.f.require=(e,r)=>{s[e]||(e=>{var r=e.modules,o=e.ids,t=e.runtime;for(var n in r)u.o(r,n)&&(u.m[n]=r[n]);t&&t(u);for(var i=0;i<o.length;i++)s[o[i]]=1})(require("./"+u.u(e)))};const l=require("compression");var a=u.n(l),c=u(8577),E=u.n(c),d=u(7252),R=u.n(d);const _=require("node:async_hooks"),p=require("node:http");var S=u.n(p),m=u(1708),O=u.n(m);const b=require("worker_threads");var h=u(9469);u(818).config(),async function(){const e=R()();async function r(){const e=new b.Worker("./four-worker.config.js",{workerData:{thread_count:4}});return new Promise(((r,o)=>{e.on("message",(e=>{r(e)})),e.on("error",(e=>{o(`Worker error: ${e}`)})),e.on("exit",(e=>{0!==e&&o(`Worker stopped with exit code ${e}`)}))}))}e.use(E()({origin:"http://localhost:8080",credentials:!0})),(await u.e(545).then(u.bind(u,1545))).default({app:e}),e.use("/heavy",((e,r)=>{const o=Array.from({length:1e6},(()=>Math.random()));let t=0;for(let e=0;e<o.length;e++)t+=o[e];r.send(`The result of the CPU = ${o} and total operation is: ${t}`)})),e.get("/non-blocking/",((e,r)=>{r.status(200).send("Non-blocking request")})),e.get("/blocking-worker",(async(e,o)=>{const t=Date.now();try{const e=await r();console.log(`Worker took ${Date.now()-t}ms to complete`),o.status(200).send(`Blocking worker: ${e}`)}catch(e){console.log(`Error in worker: ${e}`),o.status(500).send(`Blocking worker failed: ${e}`)}})),e.get("/blocking",(async(e,o)=>{const t=Date.now(),s=[];for(let e=0;e<4;e++)s.push(r());try{const e=await Promise.all(s),r=e[0]+e[1]+e[2]+e[3];console.log(`Workers took ${Date.now()-t}ms to complete`),o.status(200).send(`Blocking workers: ${r}`)}catch(e){console.log(`Error in worker: ${e}`),o.status(500).send(`Blocking workers failed: ${e}`)}}));const o=S().createServer(e),t=new _.AsyncLocalStorage;function s(e){const r=t.getStore();console.log(`${void 0!==r?r:"-"} ${e}`)}let n=0;o.on("connection",(e=>{const r=n++;t.run(r,(()=>{s("Client connected to server!!!"),e.on("close",(()=>{s("Client disconnected from server!!!")}))}))})),o.listen(h._.PORT,(()=>{console.log(`Server listening on port ${h._.PORT}`)})),e.use(a()({filter:(e,r)=>!e.headers["x-no-compression"]&&a().filter(e,r),level:h._.COMPRESSION_LEVEL||9,threshold:h._.COMPRESSION_THRESHOLD||1024}));const i=h._.IDLE_TIMEOUT||48e4;let l=setTimeout((()=>{o.close((()=>{console.log("Server closed due to idle time out! Restarting...."),O().exit(0)}))}),i);e.use(((e,r,t)=>{clearTimeout(l),l=setTimeout((()=>{o.close((()=>{console.log("Cleared Time out! Restarting...."),O().exit(0)}))}),i),t()})),O().on("uncaughtExceptionMonitor",((e,r)=>{console.log("Uncaught Exception:",e,"Origin:",r),O().exit(1)})),o.on("error",(e=>{console.error(e),O().exit(1)}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FDWixTQUFhLEVBQUUsR0FDakIsR0FDSG9CLEdBQ0hLLEdBQU0sSUFFVixPQUFXLDRCQUE0QixDQUFDdkYsRUFBSzZDLEtBQ3pDZ0IsUUFBUUMsSUFBSSxzQkFBdUI5RCxFQUFLLFVBQVc2QyxHQUNuRCxTQUFhLEVBQUUsSUFFbkJxQixFQUFPMUIsR0FBRyxTQUFTRSxJQUNmbUIsUUFBUW5CLE1BQU1BLEdBQ2QsU0FBYSxFQUFFLEdBRXZCLENBQ0ErQyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBwdi0xL3dlYnBhY2svcnVudGltZS9hc3luYyBtb2R1bGUiLCJ3ZWJwYWNrOi8vYXBwdi0xL3dlYnBhY2svcnVudGltZS9yZXF1aXJlIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vYXBwdi0xLy4vc3JjL3NlcnZlci9jb25maWcvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiQHNlcXVlbGl6ZS9jb3JlXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiQHNlcXVlbGl6ZS9tYXJpYWRiXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiYmNyeXB0XCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiYm9keS1wYXJzZXJcIiIsIndlYnBhY2s6Ly9hcHB2LTEvZXh0ZXJuYWwgY29tbW9uanMgXCJjb29raWUtcGFyc2VyXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiY29yc1wiIiwid2VicGFjazovL2FwcHYtMS9leHRlcm5hbCBjb21tb25qcyBcImRvdGVudlwiIiwid2VicGFjazovL2FwcHYtMS9leHRlcm5hbCBjb21tb25qcyBcImRvdGVudi9jb25maWdcIiIsIndlYnBhY2s6Ly9hcHB2LTEvZXh0ZXJuYWwgY29tbW9uanMgXCJleHByZXNzXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiZXhwcmVzcy1yYXRlLWxpbWl0XCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwiaGVsbWV0XCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwianNvbndlYnRva2VuXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwibW9yZ2FuXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwibXVsdGVyXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwic2VxdWVsaXplXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwidHMtZG90ZW52XCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIGNvbW1vbmpzIFwidmFsaWRhdGUtaW1hZ2UtdHlwZVwiIiwid2VicGFjazovL2FwcHYtMS9leHRlcm5hbCBub2RlLWNvbW1vbmpzIFwiYXNzZXJ0XCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJjcnlwdG9cIiIsIndlYnBhY2s6Ly9hcHB2LTEvZXh0ZXJuYWwgbm9kZS1jb21tb25qcyBcImZzXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJub2RlOmZzXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJub2RlOnBhdGhcIiIsIndlYnBhY2s6Ly9hcHB2LTEvZXh0ZXJuYWwgbm9kZS1jb21tb25qcyBcIm5vZGU6cGVyZl9ob29rc1wiIiwid2VicGFjazovL2FwcHYtMS9leHRlcm5hbCBub2RlLWNvbW1vbmpzIFwibm9kZTpwcm9jZXNzXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJub2RlOnVybFwiIiwid2VicGFjazovL2FwcHYtMS9leHRlcm5hbCBub2RlLWNvbW1vbmpzIFwicGF0aFwiIiwid2VicGFjazovL2FwcHYtMS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9hcHB2LTEvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vYXBwdi0xL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9hcHB2LTEvd2VicGFjay9ydW50aW1lL2Vuc3VyZSBjaHVuayIsIndlYnBhY2s6Ly9hcHB2LTEvd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lIiwid2VicGFjazovL2FwcHYtMS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2FwcHYtMS93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL2FwcHYtMS9leHRlcm5hbCBjb21tb25qcyBcImNvbXByZXNzaW9uXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJub2RlOmFzeW5jX2hvb2tzXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJub2RlOmh0dHBcIiIsIndlYnBhY2s6Ly9hcHB2LTEvZXh0ZXJuYWwgbm9kZS1jb21tb25qcyBcIndvcmtlcl90aHJlYWRzXCIiLCJ3ZWJwYWNrOi8vYXBwdi0xLy4vc3JjL3NlcnZlci9zZXJ2ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIHdlYnBhY2tRdWV1ZXMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgPyBTeW1ib2woXCJ3ZWJwYWNrIHF1ZXVlc1wiKSA6IFwiX193ZWJwYWNrX3F1ZXVlc19fXCI7XG52YXIgd2VicGFja0V4cG9ydHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgPyBTeW1ib2woXCJ3ZWJwYWNrIGV4cG9ydHNcIikgOiBcIl9fd2VicGFja19leHBvcnRzX19cIjtcbnZhciB3ZWJwYWNrRXJyb3IgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgPyBTeW1ib2woXCJ3ZWJwYWNrIGVycm9yXCIpIDogXCJfX3dlYnBhY2tfZXJyb3JfX1wiO1xudmFyIHJlc29sdmVRdWV1ZSA9IChxdWV1ZSkgPT4ge1xuXHRpZihxdWV1ZSAmJiBxdWV1ZS5kIDwgMSkge1xuXHRcdHF1ZXVlLmQgPSAxO1xuXHRcdHF1ZXVlLmZvckVhY2goKGZuKSA9PiAoZm4uci0tKSk7XG5cdFx0cXVldWUuZm9yRWFjaCgoZm4pID0+IChmbi5yLS0gPyBmbi5yKysgOiBmbigpKSk7XG5cdH1cbn1cbnZhciB3cmFwRGVwcyA9IChkZXBzKSA9PiAoZGVwcy5tYXAoKGRlcCkgPT4ge1xuXHRpZihkZXAgIT09IG51bGwgJiYgdHlwZW9mIGRlcCA9PT0gXCJvYmplY3RcIikge1xuXHRcdGlmKGRlcFt3ZWJwYWNrUXVldWVzXSkgcmV0dXJuIGRlcDtcblx0XHRpZihkZXAudGhlbikge1xuXHRcdFx0dmFyIHF1ZXVlID0gW107XG5cdFx0XHRxdWV1ZS5kID0gMDtcblx0XHRcdGRlcC50aGVuKChyKSA9PiB7XG5cdFx0XHRcdG9ialt3ZWJwYWNrRXhwb3J0c10gPSByO1xuXHRcdFx0XHRyZXNvbHZlUXVldWUocXVldWUpO1xuXHRcdFx0fSwgKGUpID0+IHtcblx0XHRcdFx0b2JqW3dlYnBhY2tFcnJvcl0gPSBlO1xuXHRcdFx0XHRyZXNvbHZlUXVldWUocXVldWUpO1xuXHRcdFx0fSk7XG5cdFx0XHR2YXIgb2JqID0ge307XG5cdFx0XHRvYmpbd2VicGFja1F1ZXVlc10gPSAoZm4pID0+IChmbihxdWV1ZSkpO1xuXHRcdFx0cmV0dXJuIG9iajtcblx0XHR9XG5cdH1cblx0dmFyIHJldCA9IHt9O1xuXHRyZXRbd2VicGFja1F1ZXVlc10gPSB4ID0+IHt9O1xuXHRyZXRbd2VicGFja0V4cG9ydHNdID0gZGVwO1xuXHRyZXR1cm4gcmV0O1xufSkpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5hID0gKG1vZHVsZSwgYm9keSwgaGFzQXdhaXQpID0+IHtcblx0dmFyIHF1ZXVlO1xuXHRoYXNBd2FpdCAmJiAoKHF1ZXVlID0gW10pLmQgPSAtMSk7XG5cdHZhciBkZXBRdWV1ZXMgPSBuZXcgU2V0KCk7XG5cdHZhciBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHM7XG5cdHZhciBjdXJyZW50RGVwcztcblx0dmFyIG91dGVyUmVzb2x2ZTtcblx0dmFyIHJlamVjdDtcblx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqKSA9PiB7XG5cdFx0cmVqZWN0ID0gcmVqO1xuXHRcdG91dGVyUmVzb2x2ZSA9IHJlc29sdmU7XG5cdH0pO1xuXHRwcm9taXNlW3dlYnBhY2tFeHBvcnRzXSA9IGV4cG9ydHM7XG5cdHByb21pc2Vbd2VicGFja1F1ZXVlc10gPSAoZm4pID0+IChxdWV1ZSAmJiBmbihxdWV1ZSksIGRlcFF1ZXVlcy5mb3JFYWNoKGZuKSwgcHJvbWlzZVtcImNhdGNoXCJdKHggPT4ge30pKTtcblx0bW9kdWxlLmV4cG9ydHMgPSBwcm9taXNlO1xuXHRib2R5KChkZXBzKSA9PiB7XG5cdFx0Y3VycmVudERlcHMgPSB3cmFwRGVwcyhkZXBzKTtcblx0XHR2YXIgZm47XG5cdFx0dmFyIGdldFJlc3VsdCA9ICgpID0+IChjdXJyZW50RGVwcy5tYXAoKGQpID0+IHtcblx0XHRcdGlmKGRbd2VicGFja0Vycm9yXSkgdGhyb3cgZFt3ZWJwYWNrRXJyb3JdO1xuXHRcdFx0cmV0dXJuIGRbd2VicGFja0V4cG9ydHNdO1xuXHRcdH0pKVxuXHRcdHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdGZuID0gKCkgPT4gKHJlc29sdmUoZ2V0UmVzdWx0KSk7XG5cdFx0XHRmbi5yID0gMDtcblx0XHRcdHZhciBmblF1ZXVlID0gKHEpID0+IChxICE9PSBxdWV1ZSAmJiAhZGVwUXVldWVzLmhhcyhxKSAmJiAoZGVwUXVldWVzLmFkZChxKSwgcSAmJiAhcS5kICYmIChmbi5yKyssIHEucHVzaChmbikpKSk7XG5cdFx0XHRjdXJyZW50RGVwcy5tYXAoKGRlcCkgPT4gKGRlcFt3ZWJwYWNrUXVldWVzXShmblF1ZXVlKSkpO1xuXHRcdH0pO1xuXHRcdHJldHVybiBmbi5yID8gcHJvbWlzZSA6IGdldFJlc3VsdCgpO1xuXHR9LCAoZXJyKSA9PiAoKGVyciA/IHJlamVjdChwcm9taXNlW3dlYnBhY2tFcnJvcl0gPSBlcnIpIDogb3V0ZXJSZXNvbHZlKGV4cG9ydHMpKSwgcmVzb2x2ZVF1ZXVlKHF1ZXVlKSkpO1xuXHRxdWV1ZSAmJiBxdWV1ZS5kIDwgMCAmJiAocXVldWUuZCA9IDApO1xufTsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgY2h1bmtzXG4vLyBcIjFcIiBtZWFucyBcImxvYWRlZFwiLCBvdGhlcndpc2Ugbm90IGxvYWRlZCB5ZXRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDc1MDogMVxufTtcblxuLy8gbm8gb24gY2h1bmtzIGxvYWRlZFxuXG52YXIgaW5zdGFsbENodW5rID0gKGNodW5rKSA9PiB7XG5cdHZhciBtb3JlTW9kdWxlcyA9IGNodW5rLm1vZHVsZXMsIGNodW5rSWRzID0gY2h1bmsuaWRzLCBydW50aW1lID0gY2h1bmsucnVudGltZTtcblx0Zm9yKHZhciBtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdH1cblx0fVxuXHRpZihydW50aW1lKSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHRmb3IodmFyIGkgPSAwOyBpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspXG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRzW2ldXSA9IDE7XG5cbn07XG5cbi8vIHJlcXVpcmUoKSBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYucmVxdWlyZSA9IChjaHVua0lkLCBwcm9taXNlcykgPT4ge1xuXHQvLyBcIjFcIiBpcyB0aGUgc2lnbmFsIGZvciBcImFscmVhZHkgbG9hZGVkXCJcblx0aWYoIWluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRpbnN0YWxsQ2h1bmsocmVxdWlyZShcIi4vXCIgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCkpKTtcblx0XHR9IGVsc2UgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMTtcblx0fVxufTtcblxuLy8gbm8gZXh0ZXJuYWwgaW5zdGFsbCBjaHVua1xuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0IiwiaW1wb3J0IHsgc3RyaWN0IGFzIGFzc2VydCB9IGZyb20gJ2Fzc2VydCc7XG5pbXBvcnQgeyBsb2FkIH0gZnJvbSAndHMtZG90ZW52JztcbmNvbnN0IGVudiA9IGxvYWQoe1xuICAgIFBPUlQ6IE51bWJlcixcbiAgICBOT0RFX0VOVjogWydwcm9kdWN0aW9uJywgJ2RldmVsb3BtZW50J10sXG4gICAgTU9SR0FOOiBbJ2NvbWJpbmVkJywgJ2RldicsICd0aW55J10sXG4gICAgQVBQX05BTUU6IFN0cmluZyxcbiAgICBCQVNFX1VSTDogU3RyaW5nLFxuICAgIEJBU0U2NF9FTkNPREVEOiBCdWZmZXIsXG4gICAgVFJBQ0lORzogQm9vbGVhbixcbiAgICBFWFRSQTogU3RyaW5nLFxuICAgIFJBUkVfTElNSVRfVElNRTogTnVtYmVyLFxuICAgIFJBUkVfTElNSVRfV0lORE9XX01TOiBOdW1iZXIsXG4gICAgTUFYOiBOdW1iZXIsXG4gICAgUkFSRV9MSU1JVF9NRVNTQUdFOiBTdHJpbmcsXG4gICAgUkFSRV9MSU1JVF9DT0RFOiBOdW1iZXIsXG4gICAgVFJVU1RfUFJPWFk6IEJvb2xlYW4sXG4gICAgTlVNQkVSX09GX1BST1hJRVM6IE51bWJlcixcbiAgICBJRExFX1RJTUVPVVQ6IE51bWJlcixcbiAgICBDT01QUkVTU0lPTl9MRVZFTDogTnVtYmVyLFxuICAgIENPTVBSRVNTSU9OX1RIUkVTSE9MRDogTnVtYmVyLFxuICAgIEVSUk9SX1RJTUVPVVQ6IE51bWJlcixcbiAgICAvKiBSb3V0ZXIgUmVzcG9uc2UgKi9cbiAgICBSRVNQT05TRV9TVEFUVVM6IFN0cmluZyxcbiAgICBSRVNQT05TRV9NRVNTQUdFOiBTdHJpbmcsXG4gICAgUkVTUE9OU0VfQ09ERTogTnVtYmVyLFxuICAgIFJFU1BPTlNFX0VSUk9SX0NPREU6IE51bWJlcixcbiAgICBSRVNQT05TRV9FUlJPUl9NRVNTQUdFOiBTdHJpbmcsXG4gICAgUkVTUE9OU0VfU0VSVkVSX0VSUk9SOiBTdHJpbmcsXG4gICAgUkVTUE9OU0VfRVJST1JfU1RBVFVTOiBTdHJpbmcsXG4gICAgUkVTUE9OU0VfRVJST1JfREFUQTogU3RyaW5nLFxuICAgIFJFU1BPTlNFX0VSUk9SX1NUQUNLOiBTdHJpbmcsXG4gICAgUkVTUE9OU0VfRVJST1JfTkFNRTogU3RyaW5nLFxufSk7XG5jb25zdCB7IEFQUF9OQU1FLCBUUkFDSU5HLCBQT1JULCBNT1JHQU4sIE5PREVfRU5WLCBCQVNFX1VSTCwgQkFTRTY0X0VOQ09ERUQsIEVYVFJBLCBSQVJFX0xJTUlUX1RJTUUsIFJBUkVfTElNSVRfV0lORE9XX01TLCBSRVNQT05TRV9FUlJPUl9DT0RFLCBNQVgsIFJBUkVfTElNSVRfTUVTU0FHRSwgUkFSRV9MSU1JVF9DT0RFLCBUUlVTVF9QUk9YWSwgTlVNQkVSX09GX1BST1hJRVMsIElETEVfVElNRU9VVCwgQ09NUFJFU1NJT05fTEVWRUwsIENPTVBSRVNTSU9OX1RIUkVTSE9MRCwgRVJST1JfVElNRU9VVCwgfSA9IGVudjtcbmlmIChSRVNQT05TRV9FUlJPUl9DT0RFID09PSA1MDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVybmFsIFNlcnZlciBFcnJvciEgTm8gZW52IGZpbGUgZm91bmQhJyk7XG59XG5hc3NlcnQub2soVFJBQ0lORywgJ1RyYWNpbmcgc2hvdWxkIGJlIHRydWUnKTtcbmFzc2VydC5vayhQT1JUID09PSA4MDgxLCAnUG9ydCBzaG91bGQgYmUgODA4MScpO1xuYXNzZXJ0Lm9rKE5PREVfRU5WID09PSAncHJvZHVjdGlvbicsICdOb2RlIGVudmlyb25tZW50IHNob3VsZCBiZSBwcm9kdWN0aW9uJyk7XG5hc3NlcnQub2soQkFTRV9VUkwgPT09ICdodHRwOi8vbG9jYWxob3N0OjgwODEnLCAnQmFzZSBVUkwgc2hvdWxkIGJlIGNvcnJlY3QnKTtcbmFzc2VydC5vayhCQVNFNjRfRU5DT0RFRC5lcXVhbHMoQnVmZmVyLmZyb20oJ/CfmoAnKSksICdCYXNlNjQgZW5jb2RlZCB2YWx1ZSBzaG91bGQgbWF0Y2gnKTtcbmFzc2VydC5vayhFWFRSQSA9PT0gJ3RydWUnLCAnRXh0cmEgc2hvdWxkIGJlIHRydWUnKTtcbmFzc2VydC5vayhSQVJFX0xJTUlUX1RJTUUgPT09IDkwMDAwMCwgJ1JhdGUgbGltaXQgdGltZSBzaG91bGQgYmUgMTVtJyk7XG5hc3NlcnQub2soUkFSRV9MSU1JVF9XSU5ET1dfTVMgPT09IDkwMDAwMCwgJ1JhdGUgbGltaXQgd2luZG93IHNob3VsZCBiZSAxNW0nKTtcbmFzc2VydC5vayhNQVggPT09IDEwMCwgJ01heCBzaG91bGQgYmUgMTAwJyk7XG5hc3NlcnQub2soUkFSRV9MSU1JVF9NRVNTQUdFLCAnVG9vIG1hbnkgcmVxdWVzdHMsIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXInKTtcbmFzc2VydC5vayhSQVJFX0xJTUlUX0NPREUgPT09IDQyOSwgJ1JhdGUgbGltaXQgY29kZSBzaG91bGQgYmUgNDI5Jyk7XG5hc3NlcnQub2soVFJVU1RfUFJPWFksICdUcnVzdCBwcm94eSBzaG91bGQgYmUgdHJ1ZSBpbml0aWFsbHknKTtcbmFzc2VydC5vayhOVU1CRVJfT0ZfUFJPWElFUyA9PT0gMSwgJ051bWJlciBvZiBwcm94aWVzIHNob3VsZCBiZSAxJyk7XG5hc3NlcnQub2soSURMRV9USU1FT1VUID09PSA0ODAwMDAsICdJZGxlIHRpbWVvdXQgc2hvdWxkIGJlIDhtJyk7XG5hc3NlcnQub2soQ09NUFJFU1NJT05fTEVWRUwgPT09IDksICdDb21wcmVzc2lvbiBsZXZlbCBzaG91bGQgYmUgOScpO1xuYXNzZXJ0Lm9rKENPTVBSRVNTSU9OX1RIUkVTSE9MRCA9PT0gMTAyNCwgJ0NvbXByZXNzaW9uIHRocmVzaG9sZCBzaG91bGQgYmUgMTAyNCcpO1xuYXNzZXJ0Lm9rKEVSUk9SX1RJTUVPVVQgPT09IDUwMDAsICdFcnJvciB0aW1lb3V0IHNob3VsZCBiZSA1cycpO1xuaWYgKCEvXlthLXpBLVowLTktLl0rJC8udGVzdChBUFBfTkFNRSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgQVBQX05BTUU6ICR7QVBQX05BTUV9YCk7XG59XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgcG9ydDogUE9SVCxcbiAgICBhcHBOYW1lOiBBUFBfTkFNRSxcbiAgICBiYXNlVXJsOiBCQVNFX1VSTCxcbiAgICBiYXNlNjRFbmNvZGVkOiBCQVNFNjRfRU5DT0RFRCxcbiAgICB0cmFjaW5nOiBUUkFDSU5HLFxuICAgIGV4dHJhOiBFWFRSQSxcbiAgICByYXRlTGltaXRUaW1lOiBSQVJFX0xJTUlUX1RJTUUsXG4gICAgcmF0ZUxpbWl0V2luZG93TXM6IFJBUkVfTElNSVRfV0lORE9XX01TLFxuICAgIG1heDogTUFYLFxuICAgIG1lc3NhZ2U6IFJBUkVfTElNSVRfTUVTU0FHRSxcbiAgICByYXRlTGltaXRDb2RlOiBSQVJFX0xJTUlUX0NPREUsXG4gICAgdHJ1c3RQcm94eTogVFJVU1RfUFJPWFksXG4gICAgbnVtYmVyT2ZQcm94aWVzOiBOVU1CRVJfT0ZfUFJPWElFUyxcbiAgICBpZGxlVGltZW91dDogSURMRV9USU1FT1VULFxuICAgIGNvbXByZXNzaW9uTGV2ZWw6IENPTVBSRVNTSU9OX0xFVkVMLFxuICAgIGVycm9yVGltZW91dDogRVJST1JfVElNRU9VVCxcbiAgICBsb2dzOiB7XG4gICAgICAgIG1vcmdhbjogTU9SR0FOLFxuICAgIH0sXG59O1xuZXhwb3J0IHsgZW52IH07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJAc2VxdWVsaXplL2NvcmVcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiQHNlcXVlbGl6ZS9tYXJpYWRiXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJjcnlwdFwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjb29raWUtcGFyc2VyXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNvcnNcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZG90ZW52XCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImRvdGVudi9jb25maWdcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJleHByZXNzLXJhdGUtbGltaXRcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiaGVsbWV0XCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtb3JnYW5cIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibXVsdGVyXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNlcXVlbGl6ZVwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ0cy1kb3RlbnZcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidmFsaWRhdGUtaW1hZ2UtdHlwZVwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhc3NlcnRcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY3J5cHRvXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZzXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm5vZGU6ZnNcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibm9kZTpwYXRoXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm5vZGU6cGVyZl9ob29rc1wiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJub2RlOnByb2Nlc3NcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibm9kZTp1cmxcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicGF0aFwiKTsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IChjaHVua0lkKSA9PiB7XG5cdHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZSgocHJvbWlzZXMsIGtleSkgPT4ge1xuXHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdH0sIFtdKSk7XG59OyIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFzeW5jIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gKGNodW5rSWQpID0+IHtcblx0Ly8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG5cdHJldHVybiBcIlwiICsgY2h1bmtJZCArIFwiLmJ1bmRsZS5qc1wiO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJjb21wcmVzc2lvblwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIm5vZGU6YXN5bmNfaG9va3NcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJub2RlOmh0dHBcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJ3b3JrZXJfdGhyZWFkc1wiKTsiLCJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKTtcbmltcG9ydCBjb21wcmVzc2lvbiBmcm9tICdjb21wcmVzc2lvbic7XG5pbXBvcnQgY29ycyBmcm9tICdjb3JzJztcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgQXN5bmNMb2NhbFN0b3JhZ2UgfSBmcm9tICdub2RlOmFzeW5jX2hvb2tzJztcbmltcG9ydCBodHRwIGZyb20gJ25vZGU6aHR0cCc7IC8vIENvcnJlY3RseSBpbXBvcnQgdGhlICdodHRwJyBtb2R1bGVcbmltcG9ydCBwcm9jZXNzIGZyb20gJ25vZGU6cHJvY2Vzcyc7XG5pbXBvcnQgeyBXb3JrZXIgfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7XG5pbXBvcnQgeyBlbnYgfSBmcm9tICcuL2NvbmZpZy9pbmRleCc7XG5jb25zdCBUSFJFQURfQ09VTlQgPSA0O1xuY29uc3QgV29ya2VyRmlsZVBhdGggPSAnLi9mb3VyLXdvcmtlci5jb25maWcuanMnO1xuYXN5bmMgZnVuY3Rpb24gU3RhcnRTZXJ2ZXIoKSB7XG4gICAgY29uc3QgYXBwID0gZXhwcmVzcygpO1xuICAgIGFwcC51c2UoY29ycyh7XG4gICAgICAgIG9yaWdpbjogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MCcsXG4gICAgICAgIGNyZWRlbnRpYWxzOiB0cnVlLFxuICAgIH0pKTtcbiAgICAoYXdhaXQgaW1wb3J0KCcuL2xvYWRlcnMvaW5kZXguanMnKSkuZGVmYXVsdCh7IGFwcCB9KTtcbiAgICBhcHAudXNlKCcvaGVhdnknLCAoX3JlcSwgcmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IGhlYXZ5ID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMWU2IH0sICgpID0+IE1hdGgucmFuZG9tKCkpO1xuICAgICAgICBsZXQgdG90YWwgPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYXZ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0b3RhbCArPSBoZWF2eVtpXTtcbiAgICAgICAgfVxuICAgICAgICByZXMuc2VuZChgVGhlIHJlc3VsdCBvZiB0aGUgQ1BVID0gJHtoZWF2eX0gYW5kIHRvdGFsIG9wZXJhdGlvbiBpczogJHt0b3RhbH1gKTtcbiAgICB9KTtcbiAgICBhcHAuZ2V0KCcvbm9uLWJsb2NraW5nLycsIChfcmVxLCByZXMpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoJ05vbi1ibG9ja2luZyByZXF1ZXN0Jyk7XG4gICAgfSk7XG4gICAgYXN5bmMgZnVuY3Rpb24gcnVuV29ya2VyKCkge1xuICAgICAgICBjb25zdCB3b3JrZXIgPSBuZXcgV29ya2VyKFdvcmtlckZpbGVQYXRoLCB7XG4gICAgICAgICAgICB3b3JrZXJEYXRhOiB7IHRocmVhZF9jb3VudDogVEhSRUFEX0NPVU5UIH0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgd29ya2VyLm9uKCdtZXNzYWdlJywgZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd29ya2VyLm9uKCdlcnJvcicsIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3QoYFdvcmtlciBlcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd29ya2VyLm9uKCdleGl0JywgY29kZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGBXb3JrZXIgc3RvcHBlZCB3aXRoIGV4aXQgY29kZSAke2NvZGV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhcHAuZ2V0KCcvYmxvY2tpbmctd29ya2VyJywgYXN5bmMgKF9yZXEsIHJlcykgPT4ge1xuICAgICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB3b3JrZXJSZXN1bHQgPSBhd2FpdCBydW5Xb3JrZXIoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBXb3JrZXIgdG9vayAke0RhdGUubm93KCkgLSBzdGFydH1tcyB0byBjb21wbGV0ZWApO1xuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoYEJsb2NraW5nIHdvcmtlcjogJHt3b3JrZXJSZXN1bHR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgaW4gd29ya2VyOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoYEJsb2NraW5nIHdvcmtlciBmYWlsZWQ6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBhcHAuZ2V0KCcvYmxvY2tpbmcnLCBhc3luYyAoX3JlcSwgcmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgY29uc3Qgd29ya2VyUHJvbWlzZXMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBUSFJFQURfQ09VTlQ7IGkrKykge1xuICAgICAgICAgICAgd29ya2VyUHJvbWlzZXMucHVzaChydW5Xb3JrZXIoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRocmVhZFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbCh3b3JrZXJQcm9taXNlcyk7XG4gICAgICAgICAgICBjb25zdCB0b3RhbF9yZXN1bHRzID0gdGhyZWFkUmVzdWx0c1swXSArXG4gICAgICAgICAgICAgICAgdGhyZWFkUmVzdWx0c1sxXSArXG4gICAgICAgICAgICAgICAgdGhyZWFkUmVzdWx0c1syXSArXG4gICAgICAgICAgICAgICAgdGhyZWFkUmVzdWx0c1szXTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBXb3JrZXJzIHRvb2sgJHtEYXRlLm5vdygpIC0gc3RhcnR9bXMgdG8gY29tcGxldGVgKTtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGBCbG9ja2luZyB3b3JrZXJzOiAke3RvdGFsX3Jlc3VsdHN9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgaW4gd29ya2VyOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoYEJsb2NraW5nIHdvcmtlcnMgZmFpbGVkOiAke2Vycm9yfWApO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcbiAgICBjb25zdCBhc3luY0xvY2FsU3RvcmFnZSA9IG5ldyBBc3luY0xvY2FsU3RvcmFnZSgpO1xuICAgIGZ1bmN0aW9uIGxvZ1dpdGhJZChtc2cpIHtcbiAgICAgICAgY29uc3QgaWQgPSBhc3luY0xvY2FsU3RvcmFnZS5nZXRTdG9yZSgpO1xuICAgICAgICBjb25zb2xlLmxvZyhgJHtpZCAhPT0gdW5kZWZpbmVkID8gaWQgOiAnLSd9ICR7bXNnfWApO1xuICAgIH1cbiAgICBsZXQgaWRTZXEgPSAwO1xuICAgIHNlcnZlci5vbignY29ubmVjdGlvbicsIHNvY2tldCA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gaWRTZXErKztcbiAgICAgICAgYXN5bmNMb2NhbFN0b3JhZ2UucnVuKGlkLCAoKSA9PiB7XG4gICAgICAgICAgICBsb2dXaXRoSWQoJ0NsaWVudCBjb25uZWN0ZWQgdG8gc2VydmVyISEhJyk7XG4gICAgICAgICAgICBzb2NrZXQub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxvZ1dpdGhJZCgnQ2xpZW50IGRpc2Nvbm5lY3RlZCBmcm9tIHNlcnZlciEhIScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHNlcnZlci5saXN0ZW4oZW52LlBPUlQsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYFNlcnZlciBsaXN0ZW5pbmcgb24gcG9ydCAke2Vudi5QT1JUfWApO1xuICAgIH0pO1xuICAgIGFwcC51c2UoY29tcHJlc3Npb24oe1xuICAgICAgICBmaWx0ZXI6IChyZXEsIHJlcykgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcS5oZWFkZXJzWyd4LW5vLWNvbXByZXNzaW9uJ10pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29tcHJlc3Npb24uZmlsdGVyKHJlcSwgcmVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgbGV2ZWw6IGVudi5DT01QUkVTU0lPTl9MRVZFTCB8fCA5LFxuICAgICAgICB0aHJlc2hvbGQ6IGVudi5DT01QUkVTU0lPTl9USFJFU0hPTEQgfHwgMTAyNCxcbiAgICB9KSk7XG4gICAgY29uc3QgaWRsZVRpbWVvdXQgPSBlbnYuSURMRV9USU1FT1VUIHx8IDQ4MDAwMDtcbiAgICBsZXQgaWRsZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHNlcnZlci5jbG9zZSgoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyIGNsb3NlZCBkdWUgdG8gaWRsZSB0aW1lIG91dCEgUmVzdGFydGluZy4uLi4nKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgwKTtcbiAgICAgICAgfSk7XG4gICAgfSwgaWRsZVRpbWVvdXQpO1xuICAgIGFwcC51c2UoKF9yZXEsIF9yZXMsIG5leHQpID0+IHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGlkbGVUaW1lcik7XG4gICAgICAgIGlkbGVUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgc2VydmVyLmNsb3NlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ2xlYXJlZCBUaW1lIG91dCEgUmVzdGFydGluZy4uLi4nKTtcbiAgICAgICAgICAgICAgICBwcm9jZXNzLmV4aXQoMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgaWRsZVRpbWVvdXQpO1xuICAgICAgICBuZXh0KCk7XG4gICAgfSk7XG4gICAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb25Nb25pdG9yJywgKGVyciwgb3JpZ2luKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVbmNhdWdodCBFeGNlcHRpb246JywgZXJyLCAnT3JpZ2luOicsIG9yaWdpbik7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcbiAgICBzZXJ2ZXIub24oJ2Vycm9yJywgZXJyb3IgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH0pO1xufVxuU3RhcnRTZXJ2ZXIoKTtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBTdGFydFNlcnZlcixcbn07XG4iXSwibmFtZXMiOlsid2VicGFja1F1ZXVlcyIsIndlYnBhY2tFeHBvcnRzIiwid2VicGFja0Vycm9yIiwicmVzb2x2ZVF1ZXVlIiwiaW5zdGFsbGVkQ2h1bmtzIiwiZW52IiwibG9hZCIsIlBPUlQiLCJOdW1iZXIiLCJOT0RFX0VOViIsIk1PUkdBTiIsIkFQUF9OQU1FIiwiU3RyaW5nIiwiQkFTRV9VUkwiLCJCQVNFNjRfRU5DT0RFRCIsIkJ1ZmZlciIsIlRSQUNJTkciLCJCb29sZWFuIiwiRVhUUkEiLCJSQVJFX0xJTUlUX1RJTUUiLCJSQVJFX0xJTUlUX1dJTkRPV19NUyIsIk1BWCIsIlJBUkVfTElNSVRfTUVTU0FHRSIsIlJBUkVfTElNSVRfQ09ERSIsIlRSVVNUX1BST1hZIiwiTlVNQkVSX09GX1BST1hJRVMiLCJJRExFX1RJTUVPVVQiLCJDT01QUkVTU0lPTl9MRVZFTCIsIkNPTVBSRVNTSU9OX1RIUkVTSE9MRCIsIkVSUk9SX1RJTUVPVVQiLCJSRVNQT05TRV9TVEFUVVMiLCJSRVNQT05TRV9NRVNTQUdFIiwiUkVTUE9OU0VfQ09ERSIsIlJFU1BPTlNFX0VSUk9SX0NPREUiLCJSRVNQT05TRV9FUlJPUl9NRVNTQUdFIiwiUkVTUE9OU0VfU0VSVkVSX0VSUk9SIiwiUkVTUE9OU0VfRVJST1JfU1RBVFVTIiwiUkVTUE9OU0VfRVJST1JfREFUQSIsIlJFU1BPTlNFX0VSUk9SX1NUQUNLIiwiUkVTUE9OU0VfRVJST1JfTkFNRSIsIkVycm9yIiwib2siLCJlcXVhbHMiLCJmcm9tIiwidGVzdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXF1aXJlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJTeW1ib2wiLCJxdWV1ZSIsImQiLCJmb3JFYWNoIiwiZm4iLCJyIiwiYSIsImJvZHkiLCJoYXNBd2FpdCIsImN1cnJlbnREZXBzIiwib3V0ZXJSZXNvbHZlIiwicmVqZWN0IiwiZGVwUXVldWVzIiwiU2V0IiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqIiwieCIsImRlcHMiLCJtYXAiLCJkZXAiLCJ0aGVuIiwib2JqIiwiZSIsInJldCIsIndyYXBEZXBzIiwiZ2V0UmVzdWx0IiwiZm5RdWV1ZSIsInEiLCJoYXMiLCJhZGQiLCJwdXNoIiwiZXJyIiwibiIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsImYiLCJjaHVua0lkIiwiYWxsIiwia2V5cyIsInJlZHVjZSIsInByb21pc2VzIiwidSIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiY2h1bmsiLCJtb3JlTW9kdWxlcyIsIm1vZHVsZXMiLCJjaHVua0lkcyIsImlkcyIsInJ1bnRpbWUiLCJpIiwibGVuZ3RoIiwiaW5zdGFsbENodW5rIiwiYXN5bmMiLCJhcHAiLCJydW5Xb3JrZXIiLCJ3b3JrZXIiLCJXb3JrZXIiLCJ3b3JrZXJEYXRhIiwidGhyZWFkX2NvdW50Iiwib24iLCJkYXRhIiwiZXJyb3IiLCJjb2RlIiwidXNlIiwib3JpZ2luIiwiY3JlZGVudGlhbHMiLCJkZWZhdWx0IiwiX3JlcSIsInJlcyIsImhlYXZ5IiwiQXJyYXkiLCJNYXRoIiwicmFuZG9tIiwidG90YWwiLCJzZW5kIiwic3RhdHVzIiwic3RhcnQiLCJEYXRlIiwibm93Iiwid29ya2VyUmVzdWx0IiwiY29uc29sZSIsImxvZyIsIndvcmtlclByb21pc2VzIiwidGhyZWFkUmVzdWx0cyIsInRvdGFsX3Jlc3VsdHMiLCJzZXJ2ZXIiLCJhc3luY0xvY2FsU3RvcmFnZSIsIkFzeW5jTG9jYWxTdG9yYWdlIiwibG9nV2l0aElkIiwibXNnIiwiaWQiLCJnZXRTdG9yZSIsImlkU2VxIiwic29ja2V0IiwicnVuIiwibGlzdGVuIiwiZmlsdGVyIiwicmVxIiwiaGVhZGVycyIsImxldmVsIiwidGhyZXNob2xkIiwiaWRsZVRpbWVvdXQiLCJpZGxlVGltZXIiLCJzZXRUaW1lb3V0IiwiY2xvc2UiLCJfcmVzIiwibmV4dCIsImNsZWFyVGltZW91dCIsIlN0YXJ0U2VydmVyIl0sInNvdXJjZVJvb3QiOiIifQ==